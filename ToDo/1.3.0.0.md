# 1.3.0.0

## Fixed
- `DocumentModel::SaveToXml` double space characters.
- `IGuiGraphicsParagraph` rendering and caret calculation bugs on GDI.
- `FakeDialogServiceBase` renders and selects wront files if filter applied.

## Breaking Changes
- Delete `GuiSinglelineTextBox` and `GuiMultilineTextBox`.
  - A new `GuiSinglelineTextBox` will be created, inheriting from `GuiDocumentLabel`.
  - A new `GuiMultilineTextBox` will be created, inheriting from `GuiDocumentViewer`.

## New Features
- `GuiDocumentCommonInterface` sub classes accept `GuiDocumentConfig` to control document editing and rendering behavior.
- `GuiDocumentCommonInterface` offer `ConvertToPlainText` and `LoadTextAndClearUndoRedo`/`LoadDocumentAndClearUndoRedo`
- Add `PasswordChar` to `GuiDocumentCommonInterface`, set to `\0` to disable.

## Known Issues

- `GuiDocumentViewer` loading super large text into one single paragraph (~0.2M lines) too slow
  - Demo: `https://github.com/vczh-libraries/GacUI/blob/master/Test/Resources/UnitTestSnapshots/Controls/Ribbon/GuiRibbonButtons/Dropdowns.json`
  - **Paragraph mode** plus **doubleLineBreaksBetweenParagraph==true** plus **no empty line** causing the whole text loaded into one single `IGuiGraphicsParagraph`.
    - This is the default configuration for `GuiDocumentViewer` and `GuiDocumentLabel`, it could be changed with the `Behavior` property in XML.
  - Root cause in `IDWriteTextLayout::GetMetrics`, taking most of the time.
  - When loading super big content to the control while you don't need user to undo to the previous state:
    - To load such text into `GuiMultilineTextBox` uses `LoadTextAndClearUndoRedo`.
    - To load prepared large document into `GuiDocumentViewer` uses `LoadDocumentAndClearUndoRedo`.
    - Future editing still work with undo.

## Copilot

- Generate settings.json and tasks.json. Currently supports only one unit test project. In `copilotCopyPrompt.ps1`.
- Besides learning in 0-scrum, also learn mybpreference in kb-learning.
  - Create learning document for C++, Vlpp, CurrentProject, CurrentProjectTesting
  - The first 2 files will be in KnowledgeBase
  - The rest will be in the repo, referenced by KnowledgeBase.vcxitems
  - kb-learning will remove everything that is strongly tighted to the current scrum
  - In order not to make everyting lost, the copilotPrepare.ps1 will copy all of them to a folder that will commit.
    - .github\Learnings
    - kb-learning will read all logs in this folder, learn, remember, delete.
- `copilotCopyResource.ps1` needs to prepare the `.github/Learning` folder. After kb-learning is done.
- In the end, we need another task to move kb-learning result back to knowledge base, if applicable.
- `kb-design.prompt.md`:
  - Clarify what should or should not be included in API Explanation or Design Insight.
  - Adding a new control
  - UI Operations:
    - Tab, Alt
    - Event Propagation
  - Menu interaction between owner and sub item
  - List control architecture
    - Layout
    - Virtual item management
    - Tree item management
  - XML Compiler topics ...
- `vgo -u`
  - By defauly only fetch master.
  - An option to fetch a specified branch, if it exists in remote.
  - An option to fetch every remote branches.

## Known Issues

- UnitTestSnapshotViewer
  - It becomes slow when loading a large test case like `Test\Resources\UnitTestSnapshots\Controls\Ribbon\GuiRibbonButtons\Dropdowns.json`.
  - `UnitTestSnapshotFileNode::EnsureLoaded`, `JsonParse` takes too much time.
- `indexed(FromArray(xs))` crashes, because the enumerable created by `FromArray` is released before for-loop calling `begin`.
  - `indexed` takes a const reference might be the cause.
  - Consider making a version for right-value reference.
- GacUI_Controls/GlobalHotKey tutorial: pressing hot key doesn't work.
- GacUI_Controls/ProgressAndAsync tutorial: doesn't scroll to the top after downloading.

## Milestone

- Create test cases for item or node provider for each list control.
  - NodeItemProvider
- Is it possible to print memory leaks directly to the screen when running unit test with `/C`?
  - In case when it is too many, we can clip it at the first 100 lines.
- Vlpp
  - UnitTest supports `/F:wildcard`.
- Document
  - `GuiSinglelineTextBox` and `GuiMultilineTextBox`
    - `Select` -> `SetCaret`
    - `Readonly` -> `EditMode`
  - `GuiDocumentCommonInterface::LoadTextAndClearUndoRedo`
  - `GuiDocumentCommonInterface::LoadDocumentAndClearUndoRedo`
  - `InjectDateTimeImpl` and `EjectDateTimeImpl`. Now `InjectDateTimeImpl(nullptr)` is illegal, use `EjectDateTimeImpl(nullptr)` to cancel all injection.
    - Same for locale and filesystem.
  - An introduction to how to access item provider from each list control and what they can do.